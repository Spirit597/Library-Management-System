**图书馆信息管理系统**

系统简介：

图书馆信息管理系统对两种不同的用户提供服务，其分别是图书借阅者和图书馆管理员。图书借阅者的需求是查询图书馆所存的图书、个人借阅情况及个人信息的修改；图书馆管理员可对图书借阅者的信息图书的信息、图书馆系统的信息进行管理和维护

 

功能描述：

~~\1.    两类用户可以在选择登陆身份后，使用用户名和密码登录管理系统~~

~~\2.    两类用户进入系统后可以查看个人信息，图书借阅者可修改自身部分个人信息，图书馆管理员可修改自身的全部个人信息~~

~~\3.    两类用户在登录成功后可注销或退出系统~~

~~\4.    两类用户可以在相应的界面查看（默认全部）的图书信息~~

~~\5.    两类用户可根据一定条件（编号、名称、类别等）搜索图书~~

~~\6.    两类用户可选择图书信息显示的排序方式~~

~~\7.    图书借阅者可以借书和还书，系统能够根据（借书数量上限及是否有超时的图书未还等）判断借书是否成功；根据（是否缴清罚款等）判断还书是否成功~~

------

\8.    图书馆管理员可以购买书架，系统根据经费情况判断操作是否成功

\9.    图书管理员可以查看所有分区的书架信息，

- 有多少书架（滚动区域显示，初步选择形成这样的窗口）

  - ![1571409580089](C:\Users\李智盛\AppData\Roaming\Typora\typora-user-images\1571409580089.png)

- ```c++
  //原始实现方式，继续沿用
  
  void BookShelfWidget::getShelfInfo()
  {
      for(int i = 0; i<shelfButtonLists.count();i++ )
      {
          if(shelfButtonLists[i])
          {
              delete shelfButtonLists[i];
          }
      }
      shelfButtonLists.clear();
      shelfLists.clear();
      shelfListWidget->resize(shelfListWidget->width(),0);
      int num =20;
      for(int i = 1; i <num ; ++i)
      {
          ShelfButton *singleShelfButton = new ShelfButton(shelfListWidget);
          singleShelfButton->show();
          shelfButtonLists.append(singleShelfButton);
          /*
           * 注意发送信号的过程：
           * 单个书架按钮被点击->
           * 按钮发出一个带书架编号参数的信号->
           * 书架列表窗口接收信号，创建该书架的详细信息窗口
           */
          connect(singleShelfButton, &ShelfButton::clicked, singleShelfButton, &ShelfButton::sendCreatNewWin);
          connect(singleShelfButton, &ShelfButton::ShelfNumbersignal, &shelfDetailWidget,&BookShelfDetailWidget::creteShelfDetailWin);
          connect(singleShelfButton, &ShelfButton::clicked, this, &BookShelfWidget::enterShelfDetail);
  
          QString shelfnumber = QString::number(i) ;
          singleShelfButton->setText("书架号："+shelfnumber+"\n存放书类：A");
          int row = (((i-1) / 3) + 1);
          int column = ((i - 1) % 3) + 1;
  
          singleShelfButton->move((column-1)*singleShelfButton->width()+10,(row-1) * singleShelfButton->height());
          shelfListWidget->resize(shelfListWidget->width(),shelfListWidget->height()+singleShelfButton->height());
          BookShelf *singleShelf = new BookShelf(shelfnumber,"A");
          shelfLists.append(singleShelf);
      }
  
  }
  ```

  - 现在的实现方式（栅格式可滑动窗口）,由于按钮大小和位置会随着按钮数量不同而动态变化，后来弃置了

    ![1571475112564](C:\Users\李智盛\AppData\Roaming\Typora\typora-user-images\1571475112564.png)

    ```c++
    void BookShelfWidget::getShelfInfo()
    {
        for(int i = 0; i<shelfButtonLists.count();i++ )
        {
            if(shelfButtonLists[i])
            {
                delete shelfButtonLists[i];
            }
        }
        shelfButtonLists.clear();
        shelfLists.clear();
    //    shelfButtonNum = shelfButtonLists.count();
        int num = 18;
        for(int i=1; i < num; ++i)
        {
            ShelfButton *singleShelfButton = new ShelfButton;
            /*
             * 注意发送信号的过程：
             * 单个书架按钮被点击->
             * 按钮发出一个带书架编号参数的信号->
             * 书架列表窗口接收信号，创建该书架的详细信息窗口
             */
            singleShelfButton->setSizePolicy(QSizePolicy::Expanding, QSizePolicy::Preferred);
            connect(singleShelfButton, &ShelfButton::clicked, singleShelfButton, &ShelfButton::sendCreatNewWin);
            connect(singleShelfButton, &ShelfButton::ShelfNumbersignal, &shelfDetailWidget,&BookShelfDetailWidget::creteShelfDetailWin);
            connect(singleShelfButton, &ShelfButton::clicked, this, &BookShelfWidget::enterShelfDetail);
            //  逐个加入栅格布局中
            QString shelfnumber = QString::number(i) ;
            singleShelfButton->setText("书架号："+shelfnumber+"\n存放书类：A"+"\n容量剩余："+shelfnumber+"/30");
            int row = (((i-1) / 3) + 1);
            int column = ((i - 1) % 3) + 1;
            shelfCard->addWidget(singleShelfButton,row,column,2,1,Qt::Alignment());
            //  加入书架列表
            BookShelf *singleShelf = new BookShelf(shelfnumber,"A");
            shelfLists.append(singleShelf);
        }
    
        shelfCard->setContentsMargins(20,20,20,50);
    
    
    }
    
    ```

- 每个书架上有多少书，有哪些书，（滚动显示）

  - ![1571409526402](C:\Users\李智盛\AppData\Roaming\Typora\typora-user-images\1571409526402.png)

  |                |                                          |      |
  | -------------- | ---------------------------------------- | ---- |
  | Shelf Number   | 书架的唯一标识                           |      |
  | Shelf Type     | 书架存放哪一类书（一个书架仅存放一类书） |      |
  | shelf Capicity | 已经存放的书的数量（小于一个特定的值）   |      |

  

- 若某一分区（依据图书的类别划分）的书架闲置，图书馆管理员可将其划分至另一分区；或者删除书架（前提必须是该书架空闲）（这个功能和我商量一下）

  - 这个功能放在那里？放在每个书架详细信息的窗口中





\10.  图书馆管理员可以更新、删除图书资料（未归还的书不能删除）









------

\11.  图书馆管理员可增加新图书资料（需要支付金额），系统可根据书架和经费情况判断操作是否成功

\12.  图书馆管理员可以查看、新增、更新、删除图书借阅者的资料

\13.  图书管理员可以修改罚款规则，从修改后的第二天起生效

\14.  图书馆管理员可导入数据库，或将系统当前数据库导出（先不做）

\15.  系统能够自动判断图书的借阅是否超时，并提醒借阅者还书

\16.  系统能够根据规则计算超时的图书的罚款，一并提醒借阅者

\17.  系统能够自动计算剩余金额，买书架和书需要扣除金额，罚款会增加金额

\18.  多用户操作（隐含的功能）

 

限制条件或补充说明：

\1.    图书借阅者的个人信息必须包括借书证号（唯一）、借阅图书上限、借阅天数上限，且以上三个信息只能由管理员编辑（借书证号不可编辑），以及借阅图书（数量，每一本书的剩余天数，每一本书对应的罚款等）的情况

\2.    图书信息应至少包括编号（唯一且与国家标准一致），借阅情况等

\3.    系统信息应包括经费，书架，所有图书、借出图书、未借出图书、所有图书借阅者等的情况

\4.    若借的书未到期，可进行续借，超时后必须先缴清罚款才可续借

\5.    若有超时的书未还，不可再借书

\6.    罚款可增加到图书馆的经费中

 

```c++
            else if(clientMessage.value("type").toString() == "get shelfs information")
            {
                QString sqlSentence = "select * from BookShelf";
                if(!query.exec(sqlSentence))
                {
                    qDebug()<<query.lastError()<< endl;
                }
                QJsonObject shelfsPackage;
                int number = 0;
                while(query.next())
                {
                    number++;
                    QJsonObject shelfPackage;
                    qDebug()<<query.value("ShelfNumber").toString();
                    shelfPackage.insert("ShelfNumber",query.value("ShelfNumber").toInt());
                    shelfPackage.insert("ShelfType",query.value("ShelfType").toString());
                    shelfPackage.insert("ShelfCapacity",query.value("ShelfCapacity").toInt());

                    shelfsPackage.insert("shelfs"+QString::number(number),shelfPackage);

                }
                QByteArray byte_array = QJsonDocument(shelfsPackage).toJson();
                theClient->write(byte_array);
            }

```